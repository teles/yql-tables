<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
    <meta>
        <author>Jota Teles</author>
        <description>carros</description>
    </meta>
      <bindings>
        <select produces="XML">
        <urls>
          <url>http://www.carrosaojose.com.br/veiculos?revenda_id=3639</url>
        </urls>
        <execute><![CDATA[

          var urlParaRaspar = "http://www.carrosaojose.com.br/veiculos?revenda_id=3639";
          var data = y.rest(urlParaRaspar).accept('text/html').get().response;    

          var revendaXpath = {
              rootElement: "//div[contains(@class, 'filtros-lista')][1]",
              foto: "//div[contains(@class, 'photoRev')]/img/@src",
              nome: "//div[contains(@class, 'detRev')][1]//span[contains(@class, 'titleRev')]/text()",
              endereco: "//div[contains(@class, 'endereco')][1]/p//text()",
              carrosIds: "//div[contains(@class, 'produto')]//a[contains(@class, 'favoritlink')]",
              carrosIdsContent: "//@rel"
          };

          var revendaRootElement = y.xpath(data, revendaXpath.rootElement);

          var revenda = {}
          revenda.id = 3639;
          revenda.nome= y.xpath(revendaRootElement, revendaXpath.nome);
          revenda.endereco= y.xpath(revendaRootElement, revendaXpath.endereco);
          revenda.foto= y.xpath(revendaRootElement, revendaXpath.foto);
          revenda.carros = [];

          var carrosIds = y.xpath(data, revendaXpath.carrosIds);

   // 22:         var products = y.xpath(data, "//ul[@id='ul_product_list1']/li/div");
   // 23:         var total_entries = y.xpath(data, "//div[@class='bottomPageList']/ul[@class='results']/li/p/text()");
   // 24  
   // 25          for each (var item in products) {
   // 26            results.push({
   // 27:             image: y.xpath(item, "//a[contains(@class, 'link')]/img/@src"),
   // 28:             title: y.xpath(item, "//span[@class='name entry-title']/strong/text()"),
   // 29:             description: y.xpath(item, "//span[@class='description']/text()")
   // 30            });
   // 31          }
          carros = [];
          for each(var carroId in carrosIds) {
            carros.push(carroId);
          }
          y.log(carros);


          revendaXml = <revenda></revenda>;
          revendaXml.appendChild(<id>{revenda.id}</id>);
          revendaXml.appendChild(<nome>{revenda.nome}</nome>);
          revendaXml.appendChild(<foto>{revenda.foto}</foto>);
          revendaXml.appendChild(<endereco>{revenda.endereco}</endereco>);

          response.object = carrosIds;

        ]]>
        </execute>
      </select>
      </bindings>
</table>