<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
    <meta>
        <author>Jota Teles - http://www.jotateles.com.br </author>
        <description>Essa tabela retorna dados sobre cores extra√≠dos de https://pt.wikipedia.org/wiki/Lista_de_cores</description>
        <documentationURL> http://github.com/teles/yql-tables</documentationURL>
        <sampleQuery>SELECT * FROM cores;</sampleQuery>
    </meta>
      <bindings>
        <select produces="XML">
        <execute><![CDATA[
          var url = "https://pt.wikipedia.org/wiki/Lista_de_cores";
          var data = y.rest(url).accept('text/html').get().response;

          var colorsXpath = {
              tableRowElements: "//table[contains(@id, 'toc')]//tbody//tr"
          };

          var tableRowElements = y.xpath(data, colorsXpath.tableRowElements);
          var rowsXML = new XML("<results>"+tableRowElements+"</results>");
          var rowsObject = y.xmlToJson(rowsXML);
          var rows = rowsObject.results.tr;

          var cores = <cores></cores>;

          for (var i = 0; i < rows.length; i++) {
            var columns = rows[i].td;
            var cor = <cor></cor>;

            // Pegando o nome em portugues da cor
            if(typeof rows[i].th.a !== "undefined") {
              var nome = rows[i].th.a.content;
            }
            else {
              var nome = rows[i].th.content;
            }
            var nomeAttribute = <nome>{nome}</nome>;
            cor.appendChild(nomeAttribute);

            if(typeof columns !== "undefined") {
              // y.log(columns);
              for (var j=0; j < columns.length; j++){
                // Pegando o hexa da cor
                var hexa = columns[1].content;
                var hexaAttribute = <hexadecimal>{hexa}</hexadecimal>;
              }
              cor.appendChild(hexaAttribute);
              for (var j=0; j < columns.length; j++){
                // Pegando o nome ingles da cor
                var notation = columns[8].content;
                if(typeof notation === "undefined"){
                  var notation = "undefined";
                }
                var notationAttribute = <notacao>{notation}</notacao>;
              }
              cor.appendChild(notationAttribute);
              cores.appendChild(cor);
            }
          }
          // y.log(cores);

          response.object = cores;

        ]]>
        </execute>
      </select>
      </bindings>
</table>